<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>风袖</title>
<meta name="description" content="Everyone Can (Not) Comprehend." />
<link rel="shortcut icon" href="https://Zu3zz.github.io/favicon.ico?v=1571422368180">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link href="https://cdn.remixicon.com/releases/v1.3.1/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

<link rel="stylesheet" href="https://Zu3zz.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="风袖 - Atom Feed" href="https://Zu3zz.github.io/atom.xml">



  </head>
  <body>
    <div id="app" class="main px-4 flex flex-col lg:flex-row">
      <div id="sidebar" class="sidebar-wrapper lg:static lg:w-1/4">
  <div class="lg:sticky top-0">
    <div class="sidebar-content">
      <div class="flex lg:block p-4 lg:px-0 items-center fixed lg:static lg:block top-0 right-0 left-0 bg-white z-50">
        <i class="remixicon-menu-2-line lg:mt-4 text-2xl cursor-pointer animated fadeIn" onclick="openMenu()"></i>
        <a href="https://Zu3zz.github.io">
          <img class="animated fadeInLeft avatar rounded-lg mx-4 lg:mt-32 lg:mx-0 mt-0 lg:w-24 lg:h-24 w-12 w-12" src="https://Zu3zz.github.io/images/avatar.png?v=1571422368180" alt="">
        </a>
        <h1 class="animated fadeInLeft lg:text-4xl font-extrabold lg:mt-8 mt-0 text-xl" style="animation-delay: 0.2s">风袖</h1>
      </div>
      
        <div class="animated fadeInLeft" style="animation-delay: 0.4s">
          <p class="my-4 text-gray-600 font-light hidden lg:block">
            文章目录
          </p>
          <div class="toc-container hidden lg:block">
            <ul class="markdownIt-TOC">
<li><a href="#hdfs-%E6%A6%82%E8%BF%B0">HDFS 概述</a>
<ul>
<li><a href="#hdfs-%E6%98%AF%E4%B8%80%E4%B8%AA%E5%88%86%E5%B8%83%E5%BC%8F%E7%9A%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F">HDFS 是一个分布式的文件系统</a></li>
<li><a href="#hdfs-%E5%89%8D%E6%8F%90%E5%92%8C%E8%AE%BE%E8%AE%A1%E7%9B%AE%E6%A0%87">HDFS 前提和设计目标</a></li>
<li><a href="#hdfs-%E7%9A%84%E6%9E%B6%E6%9E%84">HDFS 的架构</a></li>
<li><a href="#%E8%AF%BE%E7%A8%8B%E7%8E%AF%E5%A2%83%E4%BB%8B%E7%BB%8D">课程环境介绍：</a>
<ul>
<li><a href="#%E6%9C%AC%E8%AF%BE%E7%A8%8B%E5%BD%95%E5%88%B6%E7%9A%84%E7%B3%BB%E7%BB%9F%E6%98%AF-mac%E6%89%80%E4%BB%A5%E6%88%91%E9%87%87%E7%94%A8%E7%9A%84-linux-%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%98%AF-mac-%E8%87%AA%E5%B8%A6%E7%9A%84-shell">本课程录制的系统是 Mac，所以我采用的 linux 客户端是 mac 自带的 shell</a></li>
<li><a href="#hadoop-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA">Hadoop 环境搭建</a></li>
<li><a href="#hadoophivespark-%E7%9B%B8%E5%85%B3%E6%A1%86%E6%9E%B6%E7%9A%84%E5%AD%A6%E4%B9%A0">Hadoop/Hive/Spark 相关框架的学习：</a></li>
<li><a href="#hadoop-%E5%AE%89%E8%A3%85%E5%89%8D%E7%BD%AE%E8%A6%81%E6%B1%82">Hadoop 安装前置要求</a></li>
<li><a href="#%E5%AE%89%E8%A3%85-java">安装 Java</a></li>
<li><a href="#%E5%AE%89%E8%A3%85-ssh-%E6%97%A0%E5%AF%86%E7%A0%81%E7%99%BB%E9%99%86">安装 ssh 无密码登陆</a></li>
<li><a href="#hadoophdfs%E5%AE%89%E8%A3%85">Hadoop(HDFS)安装</a></li>
<li><a href="#hadoop-%E8%BD%AF%E4%BB%B6%E5%8C%85%E5%B8%B8%E8%A7%81%E7%9B%AE%E5%BD%95%E8%AF%B4%E6%98%8E">hadoop 软件包常见目录说明</a></li>
<li><a href="#%E6%B3%A8%E6%84%8F">注意：</a></li>
<li><a href="#hdfs-%E5%AD%98%E5%82%A8%E6%89%A9%E5%B1%95">HDFS 存储扩展：</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8-hdfs-api-%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9D%A5%E6%93%8D%E4%BD%9C-hdfs-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F">使用 HDFS API 的方式来操作 HDFS 文件系统</a></li>
<li><a href="#hdfs-%E6%93%8D%E4%BD%9Cshell-java-api">HDFS 操作：shell + Java API</a></li>
<li><a href="#%E5%81%87%E8%AE%BE%E6%9C%89%E7%9A%84%E5%B0%8F%E4%BC%99%E4%BC%B4%E4%BA%86%E8%A7%A3%E8%BF%87-mr-spark-%E7%AD%89%E7%AD%89%E8%A7%89%E5%BE%97%E8%BF%99%E4%B8%AA%E6%93%8D%E4%BD%9C%E5%BE%88%E7%AE%80%E5%8D%95">假设：有的小伙伴了解过 mr、spark 等等，觉得这个操作很简单</a></li>
<li><a href="#%E6%9C%AC%E5%AE%9E%E6%88%98%E7%9A%84%E8%A6%81%E6%B1%82%E5%8F%AA%E5%85%81%E8%AE%B8%E4%BD%BF%E7%94%A8-hdfs-api-%E8%BF%9B%E8%A1%8C%E6%93%8D%E4%BD%9C">本实战的要求：只允许使用 HDFS API 进行操作</a></li>
<li><a href="#%E7%9B%AE%E7%9A%84">目的</a></li>
<li><a href="#%E7%A1%AC%E7%BC%96%E7%A0%81-%E9%9D%9E%E5%B8%B8%E5%BF%8C%E8%AE%B3%E7%9A%84">硬编码 ： 非常忌讳的</a></li>
<li><a href="#%E5%8F%AF%E9%85%8D%E7%BD%AE">==&gt; 可配置</a></li>
<li><a href="#%E5%8F%AF%E6%8F%92%E6%8B%94%E7%9A%84%E5%BC%80%E5%8F%91%E7%AE%A1%E7%90%86%E6%96%B9%E5%BC%8F-plugin">可插拔的开发/管理方式 plugin</a></li>
<li><a href="#%E5%89%AF%E6%9C%AC%E6%91%86%E6%94%BE%E7%AD%96%E7%95%A5">副本摆放策略</a></li>
<li><a href="#hdfs-%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86">HDFS 的元数据管理</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      
    </div>
  </div>
</div>

<div class="menu-container">
  <i class="remixicon-arrow-left-line text-2xl cursor-pointer animated fadeIn close-menu-btn" onclick="closeMenu()"></i>
  <div>
    
      
        <a href="/" class="menu" style="animation-delay: 0s">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu" style="animation-delay: 0.2s">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu" style="animation-delay: 0.4s">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu" style="animation-delay: 0.6000000000000001s">
          关于
        </a>
      
    
      
        <a href="/projects" class="menu" style="animation-delay: 0.8s" target="_blank">
          项目
        </a>
      
    
  </div>
  <div class="site-footer">
    <div class="py-4 text-gray-700">By 3zz.</div>
    <a class="rss" href="https://Zu3zz.github.io/atom.xml" target="_blank">RSS</a>
  </div>
</div>
<div class="mask" onclick="closeMenu()">
</div>
      <div class="content-wrapper py-32 lg:p-8 lg:w-3/4 post-detail animated fadeIn">
        <h1 class="text-3xl font-bold lg:mt-16">HDFS系列(1)----安装</h1>
        <div class="text-sm text-gray-700 lg:my-8">
          2019-09-13 / 9 min read
        </div>
        
        <div class="post-content yue">
          <center>这篇文章咱们就来讲讲如何安装HDFS</center>
<!-- more -->
<h1 id="hdfs-概述">HDFS 概述</h1>
<ol>
<li>分布式</li>
<li>commodity hardware</li>
<li>fault-tolerant 容错</li>
<li>high throughput</li>
<li>large data sets</li>
</ol>
<h2 id="hdfs-是一个分布式的文件系统">HDFS 是一个分布式的文件系统</h2>
<ul>
<li>文件系统：Linux、Windows、Mac....
<ul>
<li>目录结构: C /</li>
<li>存放的是文件或者文件夹</li>
<li>对外提供服务：创建、修改、删除、查看、移动等等</li>
<li>普通文件系统 vs 分布式文件系统
<ul>
<li>单机</li>
<li>分布式文件系统能够横跨 N 个机器</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="hdfs-前提和设计目标">HDFS 前提和设计目标</h2>
<ul>
<li>Hardware Failure 硬件错误
<ul>
<li>每个机器只存储文件的部分数据，blocksize=128M</li>
<li>block 存放在不同的机器上的，由于容错，HDFS 默认采用 3 副本机制</li>
</ul>
</li>
<li>Streaming Data Access 流式数据访问
<ul>
<li>The emphasis is on high throughput of data access</li>
<li>rather than low latency of data access.</li>
</ul>
</li>
<li>Large Data Sets 大规模数据集</li>
<li>Moving Computation is Cheaper than Moving Data 移动计算比移动数据更划算</li>
</ul>
<h2 id="hdfs-的架构">HDFS 的架构</h2>
<ol>
<li>NameNode(master) and DataNodes(slave)</li>
<li>master/slave 的架构</li>
<li>NN:</li>
</ol>
<ul>
<li>the file system namespace
<ul>
<li>/home/hadoop/software</li>
<li>/home/hadoop/app</li>
<li>regulates access to files by clients</li>
</ul>
</li>
</ul>
<ol start="4">
<li>
<p>DN：storage</p>
</li>
<li>
<p>HDFS exposes a file system namespace and allows user data to be stored in files.</p>
</li>
<li>
<p>a file is split into one or more blocks</p>
<ul>
<li>blocksize: 128M</li>
<li>150M 拆成 2 个 block</li>
</ul>
</li>
<li>
<p>blocks are stored in a set of DataNodes</p>
<ul>
<li>为什么？ 容错！！！</li>
</ul>
</li>
<li>
<p>NameNode executes file system namespace operations：CRUD</p>
</li>
<li>
<p>determines the mapping of blocks to DataNodes</p>
<ul>
<li>
<p>a.txt 150M blocksize=128M</p>
</li>
<li>
<p>a.txt 拆分成 2 个 block 一个是 block1：128M 另一个是 block2：22M<br>
block1 存放在哪个 DN？block2 存放在哪个 DN？</p>
</li>
<li>
<p>a.txt<br>
_ block1：128M, 192.168.199.1<br>
_ block2：22M, 192.168.199.2<br>
_ get a.txt<br>
_ 这个过程对于用户来说是不感知的</p>
</li>
</ul>
</li>
<li>
<p>通常情况下：1 个 Node 部署一个组件</p>
</li>
</ol>
<h2 id="课程环境介绍">课程环境介绍：</h2>
<h3 id="本课程录制的系统是-mac所以我采用的-linux-客户端是-mac-自带的-shell">本课程录制的系统是 Mac，所以我采用的 linux 客户端是 mac 自带的 shell</h3>
<ul>
<li>如果你们是 win：xshell、crt</li>
<li>服务器/linux 地址：192.168.199.233</li>
<li>连接到 linux 环境<br>
_ 登陆：ssh hadoop@192.168.199.233<br>
_ 登陆成功以后：[hadoop@hadoop000 ~]$
<ul>
<li>linux机器：用户名hadoop、密码123456、hostname是* * hadoop000</li>
<li>创建课程中所需要的目录（合适的文件存放在合适的目录）
<ol>
<li>[hadoop@hadoop000 ~]$ mkdir software 存放课程所使用的软件安装包 2. [hadoop@hadoop000 ~]$ mkdir app       存放课程所有软件的安装目录</li>
<li>[hadoop@hadoop000 ~]$ mkdir data 存放课程中使用的数据 4. [hadoop@hadoop000 ~]$ mkdir lib       存放课程中开发过的作业jar存放的目录</li>
<li>[hadoop@hadoop000 ~]$ mkdir shell 存放课程中相关的脚本 6. [hadoop@hadoop000 ~]$ mkdir maven_resp 存放课程中使用到的 maven 依赖包存放的目录</li>
</ol>
</li>
</ul>
</li>
<li>学员问：root 密码 1. 切换 hadoop 到 root 用户：[hadoop@hadoop000 ~]$ sudo -i 2. 切换 root 到 hadoop 用户：[root@hadoop000 ~]# su hadoop 3. 我 OOTB 环境中创建的 hadoop 用户是有 sudo 权限：sudo vi /etc/hosts</li>
<li>Linux 版本： * 以前的课程是 centos6.4，本次课程升级成 centos7</li>
</ul>
<h3 id="hadoop-环境搭建">Hadoop 环境搭建</h3>
<ul>
<li>使用的 Hadoop 相关版本：CDH</li>
<li>CDH 相关软件包下载地址：http://archive.cloudera.com/cdh5/cdh/5/</li>
<li>Hadoop 使用版本：hadoop-2.6.0-cdh5.15.1</li>
<li>Hadoop 下载：wget http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.15.1.tar.gz</li>
<li>Hive 使用版本：hive-1.1.0-cdh5.15.1</li>
</ul>
<h3 id="hadoophivespark-相关框架的学习">Hadoop/Hive/Spark 相关框架的学习：</h3>
<ul>
<li>
<p>使用单机版足够</p>
</li>
<li>
<p>如果使用集群学习会导致：从入门到放弃</p>
</li>
<li>
<p>使用 Linux/Mac 学习</p>
</li>
<li>
<p>一定不要使用 Windows 搭建 Hadoop 环境</p>
</li>
<li>
<p>所以 Linux 基础是要会的</p>
</li>
</ul>
<h3 id="hadoop-安装前置要求">Hadoop 安装前置要求</h3>
<ul>
<li>Java 1.8+</li>
<li>ssh</li>
</ul>
<h3 id="安装-java">安装 Java</h3>
<ul>
<li>拷贝本地软件包到服务器：scp jdk-8u91-linux-x64.tar.gz hadoop@192.168.199.233:~/software/</li>
<li>解压 jdk 到~/app/：tar -zvxf jdk-8u91-linux-x64.tar.gz -C ~/app/</li>
<li>把 jdk 配置系统环境变量中： ~/.bash_profile - export JAVA_HOME=/home/hadoop/app/jdk1.8.0_91 - export PATH=<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mi>A</mi><mi>V</mi><msub><mi>A</mi><mi>H</mi></msub><mi>O</mi><mi>M</mi><mi>E</mi><mi mathvariant="normal">/</mi><mi>b</mi><mi>i</mi><mi>n</mi><mo>:</mo></mrow><annotation encoding="application/x-tex">JAVA_HOME/bin:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord">/</span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span></span></span></span>PATH</li>
<li>使得配置修改生效：source .bash_profile</li>
<li>验证：java -version</li>
</ul>
<h3 id="安装-ssh-无密码登陆">安装 ssh 无密码登陆</h3>
<ul>
<li>
<p>ls</p>
</li>
<li>
<p>ls -a</p>
</li>
<li>
<p>ls -la 并没有发现一个.ssh 的文件夹</p>
</li>
<li>
<p>ssh-keygen -t rsa 一路回车</p>
</li>
<li>
<p>cd ~/.ssh</p>
</li>
<li>
<p>[hadoop@hadoop000 .ssh]$ ll</p>
</li>
<li>
<p>总用量 12</p>
<pre><code class="language-shell">-rw------- 1 hadoop hadoop 1679 10月 15 02:54 id_rsa  私钥
-rw-r--r-- 1 hadoop hadoop  398 10月 15 02:54 id_rsa.pub 公钥
-rw-r--r-- 1 hadoop hadoop  358 10月 15 02:54 known_hosts
cat id_rsa.pub &gt;&gt; authorized_keys
chmod 600 authorized_keys
</code></pre>
</li>
</ul>
<h3 id="hadoophdfs安装">Hadoop(HDFS)安装</h3>
<ul>
<li>
<p>下载<br>
_ 解压：~/app<br>
_ 添加 HADOOP_HOME/bin 到系统环境变量<br>
_ 修改 Hadoop 配置文件<br>
_ hadoop-env.sh<br>
_ export JAVA_HOME=/home/hadoop/app/jdk1.8.0_91<br>
_ core-site.xml</p>
<pre><code class="language-xml">  &lt;property&gt;
      &lt;name&gt;fs.defaultFS&lt;/name&gt;
      &lt;value&gt;hdfs://hadoop000:8020&lt;/value&gt;
  &lt;/property&gt;

  hdfs-site.xml
  &lt;property&gt;
      &lt;name&gt;dfs.replication&lt;/name&gt;
      &lt;value&gt;1&lt;/value&gt;
  &lt;/property&gt;

  &lt;property&gt;
      &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
      &lt;value&gt;/home/hadoop/app/tmp&lt;/value&gt;
  &lt;/property&gt;
</code></pre>
<ul>
<li>slaves<br>
_ hadoop000<br>
_ 启动 HDFS：<br>
_ 第一次执行的时候一定要格式化文件系统，不要重复执行: hdfs namenode -format<br>
_ 启动集群：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mi>A</mi><mi>D</mi><mi>O</mi><mi>O</mi><msub><mi>P</mi><mi>H</mi></msub><mi>O</mi><mi>M</mi><mi>E</mi><mi mathvariant="normal">/</mi><mi>s</mi><mi>b</mi><mi>i</mi><mi>n</mi><mi mathvariant="normal">/</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mo>−</mo><mi>d</mi><mi>f</mi><mi>s</mi><mi mathvariant="normal">.</mi><mi>s</mi><mi>h</mi><mo>∗</mo><mi mathvariant="normal">验</mi><mi mathvariant="normal">证</mi><mo>:</mo><mn>1.</mn><mo>[</mo><mi>h</mi><mi>a</mi><mi>d</mi><mi>o</mi><mi>o</mi><mi>p</mi><mi mathvariant="normal">@</mi><mi>h</mi><mi>a</mi><mi>d</mi><mi>o</mi><mi>o</mi><mi>p</mi><mn>000</mn><mi>s</mi><mi>b</mi><mi>i</mi><mi>n</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">HADOOP_HOME/sbin/start-dfs.sh
	* 验证:
		1. [hadoop@hadoop000 sbin]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord">/</span><span class="mord mathdefault">s</span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord">/</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">s</span><span class="mord">.</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord cjk_fallback">验</span><span class="mord cjk_fallback">证</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mopen">[</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault">o</span><span class="mord mathdefault">o</span><span class="mord mathdefault">p</span><span class="mord">@</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">d</span><span class="mord mathdefault">o</span><span class="mord mathdefault">o</span><span class="mord mathdefault">p</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord mathdefault">s</span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span> jps 2. 60002 DataNode 3. 60171 SecondaryNameNode 4. 59870 NameNode 5. http://192.168.199.233:50070 6. 如果发现 jps ok，但是浏览器不 OK？ 十有八九是防火墙问题 7. 查看防火墙状态：sudo firewall-cmd --state 8. 关闭防火墙: sudo systemctl stop firewalld.service 9. 进制防火墙开机启动：</li>
</ul>
</li>
</ul>
<h3 id="hadoop-软件包常见目录说明">hadoop 软件包常见目录说明</h3>
<ul>
<li>bin：hadoop 客户端名单</li>
<li>etc/hadoop：hadoop 相关的配置文件存放目录</li>
<li>sbin：启动 hadoop 相关进程的脚本</li>
<li>share：常用例子</li>
</ul>
<h3 id="注意">注意：</h3>
<ul>
<li>
<p>start/stop-dfs.sh 与 hadoop-daemons.sh 的关系</p>
</li>
<li>
<p>start-dfs.sh</p>
<pre><code class="language-shell">hadoop-daemons.sh start namenode
hadoop-daemons.sh start datanode
hadoop-daemons.sh start secondarynamenode
</code></pre>
</li>
<li>
<p>stop-dfs.sh =</p>
</li>
<li>
<p>hadoop 常用命令：</p>
<ol>
<li>hadoop fs -ls /</li>
<li>hadoop fs -put</li>
<li>hadoop fs -copyFromLocal</li>
<li>hadoop fs -moveFromLocal</li>
<li>hadoop fs -cat</li>
<li>hadoop fs -text</li>
<li>hadoop fs -get</li>
<li>hadoop fs -mkdir</li>
<li>hadoop fs -mv 移动/改名</li>
<li>hadoop fs -getmerge</li>
<li>hadoop fs -rm</li>
<li>hadoop fs -rmdir</li>
<li>hadoop fs -rm -r</li>
</ol>
</li>
</ul>
<h3 id="hdfs-存储扩展">HDFS 存储扩展：</h3>
<ul>
<li>put: 1file ==&gt; 1...n block ==&gt; 存放在不同的节点上的</li>
<li>get: 去 nn 上查找这个 file 对应的元数据信息</li>
<li>了解底层的存储机制这才是我们真正要学习的东西，掌握 API 那是毛毛雨</li>
</ul>
<h3 id="使用-hdfs-api-的方式来操作-hdfs-文件系统">使用 HDFS API 的方式来操作 HDFS 文件系统</h3>
<ul>
<li>IDEA/Eclipse</li>
<li>Java
<ul>
<li>使用 Maven 来管理项目</li>
<li>拷贝 jar 包</li>
<li>我的所有课程都是使用 maven 来进行管理的</li>
</ul>
</li>
</ul>
<pre><code class="language-shell">Caused by: org.apache.hadoop.ipc.RemoteException
(org.apache.hadoop.security.AccessControlException):
Permission denied: user=rocky, access=WRITE,
inode=&quot;/&quot;:hadoop:supergroup:drwxr-xr-x
</code></pre>
<h3 id="hdfs-操作shell-java-api">HDFS 操作：shell + Java API</h3>
<ul>
<li>综合性的 HDFS 实战：使用 HDFS Java API 才完成 HDFS 文件系统上的文件的词频统计</li>
<li>词频统计：wordcount
<ul>
<li>/path/1.txt</li>
<li>hello world hello</li>
<li>/path/2.txt</li>
<li>hello world hello
<ul>
<li>==&gt; (hello,4) (world,2)</li>
</ul>
</li>
</ul>
</li>
<li>将统计完的结果输出到 HDFS 上去。</li>
</ul>
<h3 id="假设有的小伙伴了解过-mr-spark-等等觉得这个操作很简单">假设：有的小伙伴了解过 mr、spark 等等，觉得这个操作很简单</h3>
<h3 id="本实战的要求只允许使用-hdfs-api-进行操作">本实战的要求：只允许使用 HDFS API 进行操作</h3>
<h3 id="目的">目的</h3>
<ol>
<li>掌握 HDFS API 的操作</li>
<li>通过这个案例，让你们对于后续要学习的 mr 有一个比较好的认识</li>
</ol>
<h3 id="硬编码-非常忌讳的">硬编码 ： 非常忌讳的</h3>
<h3 id="可配置">==&gt; 可配置</h3>
<h3 id="可插拔的开发管理方式-plugin">可插拔的开发/管理方式 plugin</h3>
<h3 id="副本摆放策略">副本摆放策略</h3>
<ul>
<li>
<p>1-本 rack 的一个节点上</p>
</li>
<li>
<p>2-另外一个 rack 的节点上</p>
</li>
<li>
<p>3-与 2 相同的 rack 的另外一个节点上</p>
</li>
<li>
<p>1-本 rack 的一个节点上</p>
</li>
<li>
<p>2-本 rack 的另外一个节点上</p>
</li>
<li>
<p>3-不同 rack 的一个节点上</p>
</li>
</ul>
<h3 id="hdfs-的元数据管理">HDFS 的元数据管理</h3>
<ul>
<li>元数据：HDFS 的目录结构以及每个文件的 BLOCK 信息(id，副本系数、block 存放在哪个 DN 上)</li>
<li>存在什么地方：对应配置 ${hadoop.tmp.dir}/name/......</li>
<li>元数据存放在文件中：</li>
</ul>
<pre><code class="language-shell">/test1
/test1/a.txt
/test2
/test2/1.txt
/test2/2.txt
</code></pre>

        </div>

        


        <div class="flex justify-between py-8">
          
            <div class="prev-post">
              <a href="https://Zu3zz.github.io/post/leetcode-double-week-10">
                <h3 class="post-title">
                  <i class="remixicon-arrow-left-line"></i>
                  LeetCode-double-week-10
                </h3>
              </a>
            </div>
          

          
            <div class="next-post">
              <a href="https://Zu3zz.github.io/post/yarn-1">
                <h3 class="post-title">
                  Yarn系列(1)----基础、介绍、流程
                  <i class="remixicon-arrow-right-line"></i>
                </h3>
              </a>
            </div>
          
        </div>

        

      </div>
    </div>

    <script src="https://Zu3zz.github.io/media/prism.js"></script>  
<script>

Prism.highlightAll()

let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

// This should probably be throttled.
// Especially because it triggers during smooth scrolling.
// https://lodash.com/docs/4.17.10#throttle
// You could do like...
// window.addEventListener("scroll", () => {
//    _.throttle(doThatStuff, 100);
// });
// Only not doing it here to keep this Pen dependency-free.

window.addEventListener("scroll", event => {
  let fromTop = window.scrollY;

  mainNavLinks.forEach((link, index) => {
    let section = document.getElementById(decodeURI(link.hash).substring(1));
    let nextSection = null
    if (mainNavLinks[index + 1]) {
      nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
    }
    if (section.offsetTop <= fromTop) {
      if (nextSection) {
        if (nextSection.offsetTop > fromTop) {
          link.classList.add("current");
        } else {
          link.classList.remove("current");    
        }
      } else {
        link.classList.add("current");
      }
    } else {
      link.classList.remove("current");
    }
  });
});


document.addEventListener("DOMContentLoaded", function() {
  var lazyImages = [].slice.call(document.querySelectorAll(".post-feature-image.lazy"));

  if ("IntersectionObserver" in window) {
    let lazyImageObserver = new IntersectionObserver(function(entries, observer) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          let lazyImage = entry.target
          lazyImage.style.backgroundImage = `url(${lazyImage.dataset.bg})`
          lazyImage.classList.remove("lazy")
          lazyImageObserver.unobserve(lazyImage)
        }
      });
    });

    lazyImages.forEach(function(lazyImage) {
      lazyImageObserver.observe(lazyImage)
    })
  } else {
    // Possibly fall back to a more compatible method here
  }
});

const menuContainer = document.querySelector('.menu-container')
const menus = document.querySelectorAll('.menu-container .menu')
const mask = document.querySelector('.mask')
const contentWrapper = document.querySelector('.content-wrapper')
const latestArticle = document.querySelector('.latest-article')
const readMore = document.querySelector('.read-more')
const indexPage = document.querySelector('.index-page')

const isHome = location.pathname === '/'
if (latestArticle) {
  latestArticle.style.display = isHome ? 'block' : 'none'
  readMore.style.display = isHome ? 'block' : 'none'
  indexPage.style.display = isHome ? 'none' : 'block'
}

const openMenu = () => {
  menuContainer.classList.add('open')
  menus.forEach(menu => {
    menu.classList.add('animated', 'fadeInLeft')
  })
  mask.classList.add('open')
  contentWrapper.classList.add('is-second')
}

const closeMenu = () => {
  menuContainer.classList.remove('open')
  menus.forEach(menu => {
    menu.classList.remove('animated', 'fadeInLeft')
  })
  mask.classList.remove('open')
  contentWrapper.classList.remove('is-second')
}
</script>
  
  </body>
</html>
